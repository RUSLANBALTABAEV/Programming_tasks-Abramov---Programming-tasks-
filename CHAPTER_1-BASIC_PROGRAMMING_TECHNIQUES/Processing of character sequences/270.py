"""
ГЛАВА 1
ОСНОВНЫЕ ПРИЁМЫ ПРОГРАММИРОВАНИЯ
7. Сочетания цикла и разветвления

270. Даны символы s1, s2, … Известно, что символ s1 отличен от пробела и что среди s2, s3, … имеется хотя бы один пробел.
Рассматриваются s1, …, sn – символы, предшествующие первому пробелу (n заранее неизвестно). Преобразовать последовательность s1, …, sn:
а) удалив из нее все символы, не являющиеся буквами;
б) заменив все малые буквы одноименными большими;
в) удалив все символы, не являющиеся буквами или цифрами, и заменив каждую большую букву одноименной малой;
г) удалив из каждой группы идущих подряд цифр, в которой более двух цифр и которой предшествует точка, все цифры, начиная с третьей (например, ab + 0.1973 − 1.1 преобразуется в ab + 0.19 − 1.1); 
д) удалив из каждой группы цифр, которой не предшествует точка, все начальные нули (кроме последнего, если за ним идет точка).
"""


def main():
    # Ввод символов до первого пробела
    print("Введите символы. Первый символ не должен быть пробелом.")
    print("Среди последующих символов должен быть хотя бы один пробел.")
    print("Вводите символы по одному. Для завершения введите пробел.")
    
    s = ''
    while True:
        ch = input("Введите символ: ")
        if len(ch) != 1:
            print("Ошибка: введите ровно один символ.")
            continue
        if s == '' and ch == ' ':
            print("Ошибка: первый символ не должен быть пробелом.")
            continue
        if ch == ' ':
            break
        s += ch

    print(f"\nВведенная последовательность до первого пробела: '{s}'")
    print(f"Длина последовательности: {len(s)}")

    # а) удалить все символы, не являющиеся буквами
    result_a = ''.join(ch for ch in s if ch.isalpha())
    print(f"\nа) После удаления не-букв: '{result_a}'")

    # б) заменить все малые буквы одноименными большими
    result_b = s.upper()
    print(f"б) Все буквы в верхнем регистре: '{result_b}'")

    # в) удалить все символы, не являющиеся буквами или цифрами, 
    #    и заменить каждую большую букву одноименной малой
    result_c = ''.join(ch.lower() for ch in s if ch.isalnum())
    print(f"в) Только буквы и цифры в нижнем регистре: '{result_c}'")

    # г) удалить из каждой группы идущих подряд цифр, в которой более двух цифр 
    #    и которой предшествует точка, все цифры, начиная с третьей
    result_g = []
    i = 0
    while i < len(s):
        result_g.append(s[i])
        # Если текущий символ - точка и после нее есть хотя бы 3 цифры
        if s[i] == '.' and i + 1 < len(s) and s[i+1].isdigit():
            # Найдем группу цифр после точки
            j = i + 1
            while j < len(s) and s[j].isdigit():
                j += 1
            # Если цифр больше 2, оставляем только первые 2
            if j - (i + 1) > 2:
                # Удаляем последний добавленный символ (точку)
                result_g.pop()
                # Добавляем точку и первые две цифры
                result_g.append(s[i])  # точка
                result_g.append(s[i+1])  # первая цифра
                result_g.append(s[i+2])  # вторая цифра
                # Пропускаем остальные цифры
                i = j
                continue
        i += 1
    
    result_g_str = ''.join(result_g)
    print(f"г) После обработки групп цифр с точкой: '{result_g_str}'")

    # д) удалить из каждой группы цифр, которой не предшествует точка, 
    #    все начальные нули (кроме последнего, если за ним идет точка)
    result_d = []
    i = 0
    while i < len(s):
        # Если нашли цифру
        if s[i].isdigit():
            # Найдем всю группу цифр
            start = i
            while i < len(s) and s[i].isdigit():
                i += 1
            end = i
            
            # Проверяем, предшествует ли точке
            # (если перед группой есть символ и это точка, то пропускаем)
            if start > 0 and s[start-1] == '.':
                # Группе предшествует точка - оставляем как есть
                result_d.append(s[start:end])
            else:
                # Группе не предшествует точка - удаляем начальные нули
                group = s[start:end]
                
                # Проверяем, идет ли за группой точка
                has_dot_after = (end < len(s) and s[end] == '.')
                
                if has_dot_after:
                    # Если группа состоит только из нулей, оставляем один ноль
                    if all(ch == '0' for ch in group):
                        result_d.append('0')
                    else:
                        # Удаляем начальные нули
                        result_d.append(group.lstrip('0'))
                else:
                    # Просто удаляем начальные нули
                    stripped = group.lstrip('0')
                    if stripped == '':  # если вся группа состояла из нулей
                        pass  # не добавляем ничего
                    else:
                        result_d.append(stripped)
                
            # Уже увеличили i в цикле while, не увеличиваем снова
            continue
        else:
            # Не цифра - просто добавляем
            result_d.append(s[i])
            i += 1
    
    result_d_str = ''.join(result_d)
    print(f"д) После удаления начальных нулей в группах без точки: '{result_d_str}'")

    print("\nДля проверки преобразований:")
    print("Примеры для (г):")
    print("  '0.1973' -> '0.19'")
    print("  '1.1' -> '1.1' (без изменений)")
    print("  'ab0.12345cd' -> 'ab0.12cd'")
    print("\nПримеры для (д):")
    print("  '00123' -> '123'")
    print("  '00.123' -> '0.123'")
    print("  '001.23' -> '1.23'")
    print("  '0.001' -> '0.001' (без изменений, т.к. перед группой точка)")

if __name__ == "__main__":
    main()
    input("\n\nНажмите Enter, чтобы завершить программу.")
