"""
ГЛАВА 1
ОСНОВНЫЕ ПРИЁМЫ ПРОГРАММИРОВАНИЯ
6. Пошаговый ввод данных и вывод результатов *)

144. Последовательность чисел Фибоначчи u0,u1, ... образуется по закону u0 = 0; u1 = 1; ui = ui-1 + ui-2 (i = 2,3, ...).
а) Дано натуральное число n > 1. Получить u0,u1, ..., un.
б) Последовательность f0, f1, ... образуется по закону f0 = 0;
f1 = 1; fi = fi-1 + fi-2 + ui-2 (i = 2,3, ...). Дано натуральное n > 1.
Получить f0,f1, ..., fn.
"""


def main():
    print("Вычисление последовательностей Фибоначчи и модифицированной последовательности")
    print("=" * 70)
    
    # Ввод натурального числа n > 1
    n = int(input("Введите натуральное число n > 1: "))
    
    if n <= 1:
        print("Ошибка: n должно быть больше 1!")
        return
    
    print("\n" + "=" * 70)
    print("а) Последовательность чисел Фибоначчи u0, u1, ..., un:")
    print("   u0 = 0, u1 = 1, ui = u(i-1) + u(i-2) для i >= 2")
    print("-" * 70)
    
    # Инициализация переменных для чисел Фибоначчи
    # Для хранения двух предыдущих значений
    u_prev2 = 0  # u_{i-2}
    u_prev1 = 1  # u_{i-1}
    
    # Выводим первые два элемента
    print(f"u0 = {u_prev2}")
    print(f"u1 = {u_prev1}")
    
    # Вычисляем и выводим остальные элементы
    for i in range(2, n + 1):
        u_current = u_prev1 + u_prev2  # u_i = u_{i-1} + u_{i-2}
        print(f"u{i} = {u_current}")
        
        # Обновляем значения для следующей итерации
        u_prev2, u_prev1 = u_prev1, u_current
    
    print("\n" + "=" * 70)
    print("б) Последовательность f0, f1, ..., fn:")
    print("   f0 = 0, f1 = 1, fi = f(i-1) + f(i-2) + u(i-2) для i >= 2")
    print("   где u(i-2) - (i-2)-й элемент последовательности Фибоначчи")
    print("-" * 70)
    
    # Для вычисления f_i нам нужны:
    # - предыдущие значения f: f_{i-1} и f_{i-2}
    # - значение u_{i-2} из последовательности Фибоначчи
    
    # Нам нужно заново вычислить последовательность Фибоначчи,
    # так как мы не сохраняли все значения
    
    # Инициализация переменных для последовательности f
    f_prev2 = 0  # f_{i-2}
    f_prev1 = 1  # f_{i-1}
    
    # Инициализация переменных для последовательности u (нужна для вычисления f)
    u_for_f_prev2 = 0  # будет хранить u_{i-2}
    u_for_f_prev1 = 1  # будет хранить u_{i-1}
    
    # Выводим первые два элемента f
    print(f"f0 = {f_prev2}")
    print(f"f1 = {f_prev1}")
    
    # Вычисляем и выводим остальные элементы f
    for i in range(2, n + 1):
        # Вычисляем текущее значение u_{i-2}
        # Для i=2: u_{0} = 0
        # Для i=3: u_{1} = 1
        # и т.д.
        
        # Вычисляем f_i = f_{i-1} + f_{i-2} + u_{i-2}
        f_current = f_prev1 + f_prev2 + u_for_f_prev2
        
        print(f"f{i} = {f_prev1} + {f_prev2} + {u_for_f_prev2} = {f_current}")
        
        # Обновляем значения для следующей итерации
        
        # Для последовательности Фибоначчи:
        # Вычисляем следующее значение u (для использования на следующем шаге как u_{i-1})
        u_current = u_for_f_prev1 + u_for_f_prev2
        
        # Обновляем:
        # u_{i-2} для следующей итерации становится u_{i-1} текущей итерации
        # u_{i-1} для следующей итерации становится u_i текущей итерации
        u_for_f_prev2, u_for_f_prev1 = u_for_f_prev1, u_current
        
        # Обновляем значения f
        f_prev2, f_prev1 = f_prev1, f_current
    
    # Дополнительный вывод: сравнение двух последовательностей
    print("\n" + "=" * 70)
    print("Сравнение последовательностей u и f:")
    print("-" * 70)
    
    # Перевычисляем обе последовательности для таблицы
    print(f"{'i':>4} | {'u_i':>15} | {'f_i':>15} | {'Разность (f_i - u_i)':>20}")
    print("-" * 70)
    
    # Инициализация
    u_prev2 = 0
    u_prev1 = 1
    f_prev2 = 0
    f_prev1 = 1
    u_for_f_prev2 = 0
    u_for_f_prev1 = 1
    
    # i = 0
    print(f"{0:>4} | {u_prev2:>15} | {f_prev2:>15} | {f_prev2 - u_prev2:>20}")
    
    # i = 1
    print(f"{1:>4} | {u_prev1:>15} | {f_prev1:>15} | {f_prev1 - u_prev1:>20}")
    
    # i = 2..n
    for i in range(2, n + 1):
        # Вычисляем u_i
        u_current = u_prev1 + u_prev2
        
        # Вычисляем f_i
        f_current = f_prev1 + f_prev2 + u_for_f_prev2
        
        # Выводим строку
        print(f"{i:>4} | {u_current:>15} | {f_current:>15} | {f_current - u_current:>20}")
        
        # Обновляем значения для u
        u_prev2, u_prev1 = u_prev1, u_current
        
        # Обновляем значения для u, используемые в вычислении f
        u_next = u_for_f_prev1 + u_for_f_prev2
        u_for_f_prev2, u_for_f_prev1 = u_for_f_prev1, u_next
        
        # Обновляем значения для f
        f_prev2, f_prev1 = f_prev1, f_current
    
    # Анализ роста последовательностей
    print("\n" + "=" * 70)
    print("Анализ роста последовательностей:")
    print("-" * 70)
    
    # Вычисляем приблизительные соотношения для последних значений
    # Для этого снова перевычисляем последние значения
    u_prev2 = 0
    u_prev1 = 1
    f_prev2 = 0
    f_prev1 = 1
    u_for_f_prev2 = 0
    u_for_f_prev1 = 1
    
    for i in range(2, n + 1):
        u_current = u_prev1 + u_prev2
        f_current = f_prev1 + f_prev2 + u_for_f_prev2
        
        # Обновляем
        u_prev2, u_prev1 = u_prev1, u_current
        u_next = u_for_f_prev1 + u_for_f_prev2
        u_for_f_prev2, u_for_f_prev1 = u_for_f_prev1, u_next
        f_prev2, f_prev1 = f_prev1, f_current
    
    print(f"Последние вычисленные значения:")
    print(f"  u_{n} = {u_prev1}")
    print(f"  f_{n} = {f_prev1}")
    
    if n >= 3:
        # Отношение соседних элементов Фибоначчи стремится к золотому сечению
        u_n_minus_1 = u_prev2  # это u_{n-1}
        ratio_u = u_prev1 / u_n_minus_1 if u_n_minus_1 != 0 else float('inf')
        print(f"\nДля последовательности Фибоначчи:")
        print(f"  Отношение u_{n}/u_{n-1} = {ratio_u:.6f}")
        print(f"  Золотое сечение φ ≈ 1.618034")
        
        # Для последовательности f тоже можно посмотреть отношение
        f_n_minus_1 = f_prev2  # это f_{n-1}
        ratio_f = f_prev1 / f_n_minus_1 if f_n_minus_1 != 0 else float('inf')
        print(f"\nДля модифицированной последовательности:")
        print(f"  Отношение f_{n}/f_{n-1} = {ratio_f:.6f}")

if __name__ == "__main__":
    main()
    input("\n\nНажмите Enter, чтобы завершить программу.")
