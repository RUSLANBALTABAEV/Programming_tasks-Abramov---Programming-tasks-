"""
ГЛАВА 1
ОСНОВНЫЕ ПРИЁМЫ ПРОГРАММИРОВАНИЯ
6. Пошаговый ввод данных и вывод результатов *)

145. Последовательность x1,x2, ... образована по закону:
а) x1 = 0; x2 = 5 / 8; xi = (xi-1) / 2 + 3 / 4 * xi-2, i = 3,4, ...;
б) x1 = 1; x2 = 0.3; xi = (i + 1) * xi-2, i = 3,4, ...;
в) x1 = x2 = x3 = 1; xi = (i + 3) * (xi-1 - 1) + (i + 4) * xi-3, i = 4,5, ...;
Получить x1,x2, ..., x20;
"""


def main():
    print("Вычисление трех различных последовательностей x1...x20")
    print("=" * 80)
    
    print("\nа) Последовательность: x1 = 0; x2 = 5/8; xi = x(i-1)/2 + 3/4 * x(i-2) для i >= 3")
    print("-" * 80)
    
    # Инициализация первых двух элементов
    x_prev2 = 0          # x_{i-2}
    x_prev1 = 5/8        # x_{i-1}
    
    print(f"x1 = {x_prev2}")
    print(f"x2 = {x_prev1}")
    
    # Вычисление и вывод элементов x3..x20
    for i in range(3, 21):
        x_current = x_prev1 / 2 + (3/4) * x_prev2
        print(f"x{i} = {x_prev1:.6f}/2 + 3/4*{x_prev2:.6f} = {x_current:.6f}")
        
        # Обновляем значения для следующей итерации
        x_prev2, x_prev1 = x_prev1, x_current
    
    print("\n" + "=" * 80)
    print("б) Последовательность: x1 = 1; x2 = 0.3; xi = (i+1) * x(i-2) для i >= 3")
    print("-" * 80)
    
    # Инициализация первых двух элементов
    x_prev2 = 1          # x_{i-2}
    x_prev1 = 0.3        # x_{i-1}
    
    print(f"x1 = {x_prev2}")
    print(f"x2 = {x_prev1}")
    
    # Вычисление и вывод элементов x3..x20
    for i in range(3, 21):
        x_current = (i + 1) * x_prev2
        print(f"x{i} = ({i}+1) * {x_prev2:.6f} = {x_current:.6f}")
        
        # Обновляем значения для следующей итерации
        x_prev2, x_prev1 = x_prev1, x_current
    
    print("\n" + "=" * 80)
    print("в) Последовательность: x1 = x2 = x3 = 1; xi = (i+3)*(x(i-1)-1) + (i+4)*x(i-3) для i >= 4")
    print("-" * 80)
    
    # Инициализация первых трех элементов
    x_prev3 = 1          # x_{i-3}
    x_prev2 = 1          # x_{i-2}
    x_prev1 = 1          # x_{i-1}
    
    print(f"x1 = {x_prev3}")
    print(f"x2 = {x_prev2}")
    print(f"x3 = {x_prev1}")
    
    # Вычисление и вывод элементов x4..x20
    for i in range(4, 21):
        x_current = (i + 3) * (x_prev1 - 1) + (i + 4) * x_prev3
        print(f"x{i} = ({i}+3)*({x_prev1:.6f}-1) + ({i}+4)*{x_prev3:.6f} = {x_current:.6f}")
        
        # Обновляем значения для следующей итерации
        x_prev3, x_prev2, x_prev1 = x_prev2, x_prev1, x_current
    
    # Дополнительно: вывод всех последовательностей в табличном формате
    print("\n" + "=" * 80)
    print("Сводная таблица всех трех последовательностей:")
    print("=" * 80)
    print(f"{'i':>4} | {'а) xi':>15} | {'б) xi':>15} | {'в) xi':>15}")
    print("-" * 80)
    
    # Пересчитываем все последовательности для таблицы
    
    # а) 
    x_a = [0, 5/8]
    for i in range(2, 20):
        x_a.append(x_a[i-1]/2 + (3/4)*x_a[i-2])
    
    # б)
    x_b = [1, 0.3]
    for i in range(2, 20):
        x_b.append((i+1) * x_b[i-2])  # i в коде соответствует i+1 в задаче, так как индексация с 0
    
    # в)
    x_c = [1, 1, 1]
    for i in range(3, 20):
        x_c.append((i+3) * (x_c[i-1] - 1) + (i+4) * x_c[i-3])
    
    # Выводим таблицу
    for i in range(20):
        print(f"{i+1:>4} | {x_a[i]:>15.8f} | {x_b[i]:>15.8f} | {x_c[i]:>15.8f}")
    
    # Анализ поведения последовательностей
    print("\n" + "=" * 80)
    print("Анализ поведения последовательностей:")
    print("-" * 80)
    
    print("\nа) Линейное рекуррентное соотношение с постоянными коэффициентами:")
    print("   xi = 0.5*x(i-1) + 0.75*x(i-2)")
    print("   Характеристическое уравнение: r² - 0.5r - 0.75 = 0")
    print("   Корни: r1 ≈ 1.0, r2 ≈ -0.5")
    print("   Последовательность сходится к пределу: 5/7 ≈ 0.7142857")
    print(f"   x20 = {x_a[19]:.8f}, предел = {5/7:.8f}")
    
    print("\nб) Последовательность с множителем, зависящим от номера:")
    print("   xi = (i+1)*x(i-2)")
    print("   Для четных i: xi зависит от x2")
    print("   Для нечетных i: xi зависит от x1")
    print("   Значения быстро растут из-за множителя (i+1)")
    print(f"   x20 = {x_b[19]:.8f}")
    
    print("\nв) Сложное рекуррентное соотношение:")
    print("   xi = (i+3)*(x(i-1)-1) + (i+4)*x(i-3)")
    print("   Соотношение связывает элементы с шагами 1 и 3")
    print("   Значения могут быстро расти из-за множителей (i+3) и (i+4)")
    print(f"   x20 = {x_c[19]:.8f}")

if __name__ == "__main__":
    main()
    input("\n\nНажмите Enter, чтобы завершить программу.")
