"""
ГЛАВА 1
ОСНОВНЫЕ ПРИЁМЫ ПРОГРАММИРОВАНИЯ
4. Простейшие циклы

98. Пусть
a1 = b1 = 1; ak = 3 * bk-1 + 2 * ak-1;
bk = 2 * ak-1 + bk-1, k = 2,3,...

Дано натуральное n. Найти
"""


import math


def main():
    # Ввод натурального числа n
    n = int(input("Введите натуральное число n: "))
    
    if n < 1:
        print("n должно быть натуральным числом")
        return
    
    # Инициализация начальных значений
    a_prev = 1  # a1
    b_prev = 1  # b1
    
    # Инициализация суммы
    total = 0
    
    # Инициализация факториала и степени двойки
    fact = 1  # 0! = 1
    pow2 = 1  # 2^0 = 1
    
    # Вычисление суммы для i=1..n
    for i in range(1, n + 1):
        # Обновляем факториал: i! = (i-1)! * i
        fact *= i
        
        # Обновляем степень двойки: 2^i = 2^(i-1) * 2
        pow2 *= 2
        
        # Вычисляем текущий член суммы
        term = pow2 / ((1 + a_prev**2 + b_prev**2) * fact)
        total += term
        
        # Если это не последняя итерация, вычисляем a и b для следующего i
        if i < n:
            a_new = 3 * b_prev + 2 * a_prev
            b_new = 2 * a_prev + b_prev
            
            # Обновляем значения для следующей итерации
            a_prev, b_prev = a_new, b_new
    
    # Вывод результата
    print(f"Сумма от i=1 до {n} (2^i / ((1 + a_i^2 + b_i^2) * i!)) = {total}")


if __name__ == "__main__":
    main()
    input("\nНажмите Enter, чтобы завершить программу.")
